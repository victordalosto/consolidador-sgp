select
	ocor.id_log as id,
	max(CASE WHEN ocor.id_tipo_ocorrencia IN (3) THEN tipo.nm_tipo_ocorrencia else '' END) as 'FISSURA',
	max(CASE WHEN ocor.id_tipo_ocorrencia IN (4) THEN tipo.nm_tipo_ocorrencia else '' END) as 'FC2',
	max(CASE WHEN ocor.id_tipo_ocorrencia IN (6) THEN tipo.nm_tipo_ocorrencia else '' END) as 'FC3',
	max(CASE WHEN ocor.id_tipo_ocorrencia IN (7) THEN tipo.nm_tipo_ocorrencia else '' END) as 'AFUNDAMENTO',
	max(CASE WHEN ocor.id_tipo_ocorrencia IN (8) THEN tipo.nm_tipo_ocorrencia else '' END) as 'PANELA',
	max(CASE WHEN ocor.id_tipo_ocorrencia IN (9) THEN tipo.nm_tipo_ocorrencia else '' END) as 'REMENDO',
	max(CASE WHEN ocor.id_tipo_ocorrencia IN (10) THEN tipo.nm_tipo_ocorrencia else '' END) as 'EXSUDACAO',
	max(CASE WHEN ocor.id_tipo_ocorrencia IN (11) THEN tipo.nm_tipo_ocorrencia else '' END) as 'ESCORREGAMENTO',
	max(CASE WHEN ocor.id_tipo_ocorrencia IN (12) THEN tipo.nm_tipo_ocorrencia else '' END) as 'DESGASTE',
	max(CASE WHEN ocor.id_tipo_ocorrencia IN (13) THEN tipo.nm_tipo_ocorrencia else '' END) as 'QUEBRA_BORDO'
from tb_ocorrencia_log ocor
join tb_log logs on ocor.id_log = logs.id_log
join tb_trecho trecho on trecho.id_trecho = logs.id_trecho
left join tb_tipo_ocorrencia tipo on tipo.id_tipo_ocorrencia = ocor.id_tipo_ocorrencia
left join tb_detalhe_ocorrencia det on det.id_detalhe_ocorrencia = ocor.id_detalhe_ocorrencia
where
	ocor.id_tipo_ocorrencia in (3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 82, 96, 98, 99, 100, 101, 102, 104, 106, 107, 108, 109)
	--and ocor.id_detalhe_ocorrencia in (101, 102, 103) --104 =CONCRETO
	and trecho.id_ciclo = 10
	and trecho.nm_uf = 'RN'
	and trecho.nm_br = '101'
	and logs.hodometro_trecho <= 22
group by ocor.id_log